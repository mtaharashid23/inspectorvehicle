$(function () {
	sliderInit()
	replaceHash()
	lenisSetup()
	const urlParams = new URLSearchParams(window.location.search);
	const vin = urlParams.get('vin');
	if (vin) {
		const vinElement = document.querySelector('.vin_number');
		if (vinElement) vinElement.textContent = vin;
	}
})

function lenisSetup() {
	const lenis = new Lenis({
		duration: 1.5,
		easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
		smooth: true,
		mouseMultiplier: 1,
	});

	function raf(time) {
		lenis.raf(time);
		requestAnimationFrame(raf);
	}
	requestAnimationFrame(raf);
	document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
		anchor.addEventListener("click", function (e) {
			e.preventDefault();
			lenis.scrollTo(this.getAttribute("href"));
		});
	});
	lenis.scrollTo("top");
}

function replaceHash() {
	document.querySelectorAll("a").forEach((a) => {
		let href = a.getAttribute("href");
		a.href = href ?
			href.startsWith("#") && href.endsWith("#") ?
			href.replace("#", "javascript:void(0)") :
			href :
			"javascript:void(0)";
	});
}

function sliderInit() {
	const swiperOptions = {
		loop: true,
		speed: 1000,
		parallax: true,
		autoplay: {
			delay: 3500,
			disableOnInteraction: false,
		},
		autoplay: false,
		grabCursor: false,
		pagination: {
			el: '.swiper-pagination',
			clickable: true
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev'
		}
	};
	var bannerSlider = new Swiper('.bannerSlider', swiperOptions);
	var pageSections = document.querySelectorAll('.bannerImg');
	pageSections.forEach(function (pageSection) {
		var backgroundUrl = pageSection.getAttribute('data-background');
		if (backgroundUrl) {
			pageSection.style.backgroundImage = 'url(' + backgroundUrl + ')';
		}
	});

	var logoSlider = new Swiper('.logoSlider', {
		loop: true,
		autoplay: true,
		slidesPerView: 1,
		spaceBetween: 10,
		centeredSlides: true,
		roundLengths: true,
		breakpoints: {
			1199: {
				slidesPerView: 5,
				spaceBetween: 10
			},
			768: {
				slidesPerView: 4,
				spaceBetween: 10
			},
			576: {
				slidesPerView: 3,
				spaceBetween: 10
			},
			375: {
				slidesPerView: 2,
				spaceBetween: 10
			}
		},
	});

	var industrySlider = new Swiper('.industrySlider', {
		loop: true,
		slidesPerView: 4,
		spaceBetween: 20,
		breakpoints: {
			1024: {
				slidesPerView: 4,
				spaceBetween: 20
			},
			768: {
				slidesPerView: 1,
				spaceBetween: 20
			},
			640: {
				slidesPerView: 1,
				spaceBetween: 10
			},
			576: {
				slidesPerView: 1,
				spaceBetween: 10
			},
			375: {
				slidesPerView: 1,
				spaceBetween: 10
			}
		},
		navigation: {
			nextEl: '.swiper-button-next',
			prevEl: '.swiper-button-prev'
		},
		scrollbar: {
			el: '.swiper-scrollbar'
		}
	});
}

document.querySelectorAll('form.hf-form').forEach(form => {
	const nextBtn = form.querySelector('#nextBtn');
	const getReportBtn = form.querySelector('#getReportBtn');
	const inputs = form.querySelectorAll('.main_banner_form input');
	let currentStep = 0;

	if (!nextBtn || !getReportBtn || inputs.length === 0) {
		console.error("Form ya inputs nahi mile!");
		return;
	}

	// Hide all inputs except the first
	inputs.forEach(input => input.classList.remove('active'));
	inputs[0].classList.add('active');

	nextBtn.addEventListener('click', function () {
		const currentInput = inputs[currentStep];

		// Validate current input
		if (!currentInput.checkValidity()) {
			currentInput.reportValidity();
			return;
		}

		// Move to next step
		if (currentStep < inputs.length - 1) {
			inputs[currentStep].classList.remove('active');
			currentStep++;
			inputs[currentStep].classList.add('active');
		}

		// If last input, switch buttons
		if (currentStep === inputs.length - 1) {
			nextBtn.classList.add('d-none'); // Hide Next
			getReportBtn.classList.remove('d-none'); // Show Get Report
		}
	});

	// Handle submit
	form.addEventListener('submit', function (e) {
		e.preventDefault();
		getReportBtn.disabled = true;
	});
});